<link rel="stylesheet" href="/assets/assets/css/signature/signature-custom.css"  type="text/css">
<link rel="stylesheet" href="/assets/plugins/sweet-alert2/sweetalert2.min.css"  type="text/css">
<!-- <i appLoadScript [script]="'https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js'"></i> -->
<i appLoadScript [script]="'/assets/assets/custom/signature/html2canvas1.0.0.js'"></i>

<div class="container-fluid">
    <!-- Page-Title -->
    <div class="row">
        <div class="col-sm-12">
            <div class="page-title-box">
                <div class="float-right">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="javascript:void(0);">Metrica</a></li>
                        <li class="breadcrumb-item"><a href="javascript:void(0);">Patients</a></li>
                        <li class="breadcrumb-item active">All Patients</li>
                    </ol>
                </div>
                <h4 class="page-title">All Patients</h4>
            </div><!--end page-title-box-->
        </div><!--end col-->
    </div>
    <!-- end page title end breadcrumb -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div *ngIf="errorMessage" class="alert alert-danger mt-3 mb-2"><span class="fa fa-info-circle mr-2" style="font-size: 16px;"></span>{{errorMessage}}</div>
                    <button type="button" class="btn btn-primary px-4 mt-0 mb-3" onclick="location.href='../hospital/add-patient.html'"><i class="mdi mdi-plus-circle-outline mr-2"></i>Add New Patient</button>
                    <div class="table-responsive">
                        <table id="datatable" class="table table-striped">
                            <thead class="thead-light">
                            <tr>
                                <th>Patient Name</th>
                                <th>Age</th>
                                <th>Mobile No</th>
                                <th>Last Visit</th>
                                <th class="text-center cell-small-8" >Treatment Plan</th>                                                
                                <th class="text-center cell-small-7">Consent Form</th>                                                
                                <th class="text-right">Action</th>
                            </tr><!--end tr-->
                            </thead>

                            <tbody *ngIf="patientResponse !== null">
                                <tr *ngFor="let patient of patients">
                                    <td><a type="button" (click)="openProfileModal(mdPatientProfileModal, patient)"><img
                                                src="./assets/assets/images/users/user-10.jpg" alt=""
                                                class="thumb-sm rounded-circle mr-2">{{patient.firstname}} {{patient.lastname}}</a></td>
                                    <td>{{ageFromDataOfBirth(patient.birthdate)}}</td>
                                    <td>{{patient.cell}}</td>
                                    <td>{{patient.last_visit  | date:"MM/dd/yyyy"}}</td>
                                    <td class="text-center">
                                        <a type="button" id="showBill" title="Show bill" (click)="openTreatmentPlanModal(patientTreatmentPlan, patient)"
                                            class="btn btn-light" href="#" style="color: orangered;font-size:1.3em">
                                            <i class="far fa-file-alt text-primary font-18" aria-hidden="true"></i>
                                        </a>
                                    </td>
                                    <td class="text-center">
                                        <div class="dropdown d-inline-block">
                                            <a class="nav-link dropdown-toggle arrow-none" id="dLabel4" data-toggle="dropdown" href="#"
                                                role="button" aria-haspopup="false" aria-expanded="false">
                                                <i class="fas fa-ellipsis-v font-20 text-muted"></i>
                                            </a>
                                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dLabel4">
                                                <a class="dropdown-item" *ngFor="let type of consentTypes" (click)="openConsent(patient.patient_id, type.id)">{{type.name}}</a>
                                                <!-- <a class="dropdown-item" (click)="openConsent(patient.patient_id, 1)">Extraction</a>
                                                <a class="dropdown-item" href="#">Denture</a>
                                                <a class="dropdown-item" href="#">Crown</a>
                                                <a class="dropdown-item" href="#">Photography</a>
                                                <a class="dropdown-item" href="#">Crown & Bridge</a>
                                                <a class="dropdown-item" href="#">Full & Partial Denture</a>
                                                <a class="dropdown-item" href="#">Dentistry Informed spanish</a>
                                                <a class="dropdown-item" href="#">Dentistry Minor spanish</a> -->
                                            </div>
                                        </div>
                                    </td>
                                    <td class="text-right">
                                        <a href="../hospital/patient-edit.html" class="mr-2"><i class="fas fa-edit text-info font-16"></i></a>
                                        <a href="#"><i class="fas fa-trash-alt text-danger font-16"></i></a>
                                    </td>
                                </tr><!--end tr-->
                            </tbody>
                        </table>                    
                    </div>                                         
                </div><!--end card-body--> 
            </div><!--end card--> 
        </div> <!--end col-->                               
    </div><!--end row--> 

</div><!-- container -->
<ng-template #mdPatientProfileModal let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title mt-0" id="patientProfileModal">Patient Profile</h5>
            <button type="button" class="close" (click)="modal.dismiss()" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <form>
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-4 align-self-center">
                                        <div class="media">
                                            <img src="./assets/assets/images/users/user-4.jpg" alt="user"
                                                class="rounded-circle thumb-xl mr-3 align-self-center">
                                            <div class="media-body align-self-center">
                                                <h4 class="mt-0">{{name}}</h4>
                                                <p class="mb-0 text-muted">

                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <!--end col-->
                                    <div class="col-lg-8 ml-auto">
                                        <p>
                                            <span class="personal-detail-title">Name</span>
                                            <span class="personal-detail-info">{{name}}</span>
                                        </p>
                                        <p>
                                            <span class="personal-detail-title">Admit Date</span>
                                            <span class="personal-detail-info">{{(firstvisit === 'Yet to update') ? 'Yet to update' : (firstvisit | date:"MM/dd/yyyy")}}</span>
                                        </p>
                                        <p>
                                            <span class="personal-detail-title">Phone No</span>
                                            <span class="personal-detail-info">{{phone}}</span>
                                        </p>
                                        <p>
                                            <span class="personal-detail-title">Address</span>
                                            <span class="personal-detail-info">{{address}}</span>
                                        </p>
                                        <p>
                                            <span class="personal-detail-title">Email</span>
                                            <span class="personal-detail-info">{{emailaddr}}</span>
                                        </p>
                                        <p class="mb-lg-0">
                                            <span class="personal-detail-title">Doctor Name</span>
                                            <span class="personal-detail-info">Dr. {{doctorName}}</span>
                                        </p>
                                    </div>
                                    <!--end col-->
                                </div>
                                <!--end row-->
                            </div>
                            <!--end card-body-->

                        </div>
                        <!--end card-->
                    </div>
                    <!--end col-->
                </div>
                <!--end row-->
                <div class="row">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-4">Latest Activity</h4>
                                <div class="slimscroll profile-activity-height">
                                    <div class="activity">
                                        <div class="activity-info">
                                            <div class="icon-info-activity">
                                                <i class="mdi mdi-checkbox-marked-circle-outline bg-soft-success"></i>
                                            </div>
                                            <div class="activity-info-text">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="text-muted mb-0 font-14 w-75"><span
                                                            class="text-dark font-14">Donald</span>
                                                        updated the status of <a href="" class="text-dark">Refund
                                                            #1234</a> to awaiting customer response
                                                    </p>
                                                    <span class="text-muted">10 Min ago</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="activity-info">
                                            <div class="icon-info-activity">
                                                <i class="mdi mdi-timer-off bg-soft-pink"></i>
                                            </div>
                                            <div class="activity-info-text">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="text-muted mb-0 font-14 w-75"><span
                                                            class="text-dark font-14">Lucy Peterson</span>
                                                        was added to the group, group name is <a href=""
                                                            class="text-dark">Overtake</a>
                                                    </p>
                                                    <span class="text-muted">50 Min ago</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="activity-info">
                                            <div class="icon-info-activity">
                                                <i class="mdi mdi-alert-decagram bg-soft-purple"></i>
                                            </div>
                                            <div class="activity-info-text">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="text-muted mb-0 font-14 w-75"><span
                                                            class="text-dark font-14">Joseph Rust</span>
                                                        opened new showcase <a href="" class="text-dark">Mannat
                                                            #112233</a> with theme market
                                                    </p>
                                                    <span class="text-muted">10 hours ago</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="activity-info">
                                            <div class="icon-info-activity">
                                                <i class="mdi mdi-clipboard-alert bg-soft-warning"></i>
                                            </div>
                                            <div class="activity-info-text">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="text-muted mb-0 font-14 w-75"><span
                                                            class="text-dark font-14">Donald</span>
                                                        updated the status of <a href="" class="text-dark">Refund
                                                            #1234</a> to awaiting customer response
                                                    </p>
                                                    <span class="text-muted">Yesterday</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="activity-info">
                                            <div class="icon-info-activity">
                                                <i class="mdi mdi-clipboard-alert bg-soft-secondary"></i>
                                            </div>
                                            <div class="activity-info-text">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="text-muted mb-0 font-14 w-75"><span
                                                            class="text-dark font-14">Lucy Peterson</span>
                                                        was added to the group, group name is <a href=""
                                                            class="text-dark">Overtake</a>
                                                    </p>
                                                    <span class="text-muted">14 Nov 2019</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="activity-info">
                                            <div class="icon-info-activity">
                                                <i class="mdi mdi-clipboard-alert bg-soft-info"></i>
                                            </div>
                                            <div class="activity-info-text">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="text-muted mb-0 font-14 w-75"><span
                                                            class="text-dark font-14">Joseph Rust</span>
                                                        opened new showcase <a href="" class="text-dark">Mannat
                                                            #112233</a> with theme market
                                                    </p>
                                                    <span class="text-muted">15 Nov 2019</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--end activity-->
                                </div>
                                <!--crypot dash activity-->
                            </div>
                            <!--end card-body-->
                        </div>
                        <!--end card-->
                        <!--end card-->
                    </div>
                    <!--end col-->

                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title mt-0 mb-3">My Skills</h4>
                                <div class="row">
                                    <div class="col-4">
                                        <img src="./assets/assets/images/widgets/sales-re.svg" alt="" class="img-fluid">
                                    </div>
                                    <div class="col-8 align-self-center">
                                        <p class="skill-detail">Contrary to popular belief, Lorem Ipsum is not
                                            simply random text.
                                            It has roots in a piece of classical Latin literature from 45 BC,
                                            making it over 2000 years old. Richard McClintock, a Latin professor
                                            at Hampden-Sydney College in Virginia, looked up one of the more obscure
                                            Latin words.
                                        </p>
                                    </div>
                                </div>
                                <div class="skills mt-4">
                                    <div class="skill-box">
                                        <h4 class="skill-title">Replacement</h4>
                                        <div class="progress-line">
                                            <span data-percent="78" style="width: 78%;">
                                                <span class="percent-tooltip">78%</span>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="skill-box">
                                        <h4 class="skill-title">Complex Problem Solving</h4>
                                        <div class="progress-line">
                                            <span data-percent="90" style="width: 90%;">
                                                <span class="percent-tooltip">90%</span>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="skill-box">
                                        <h4 class="skill-title">Patient Care Skills</h4>
                                        <div class="progress-line">
                                            <span data-percent="80" style="width: 80%;">
                                                <span class="percent-tooltip">80%</span>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="skill-box">
                                        <h4 class="skill-title">Scientific Skills</h4>
                                        <div class="progress-line">
                                            <span data-percent="95" style="width: 95%;">
                                                <span class="percent-tooltip">95%</span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--end card-body-->
                        </div>
                        <!--end card-->
                    </div>
                    <!--end col-->
                </div>
                <!--end row-->
            </form>
            <!--end form-->
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-secondary" (click)="modal.dismiss('Cross click')" aria-label="Close">Close</button>
        </div>
    </div>
</ng-template>

<ng-template #patientTreatmentPlan let-modal>
    <div class="modal-header">
        <h5 class="modal-title mt-0" id="mdTreatmentPlan">Treatment plan details</h5>
        <button type="button" class="close" (click)="modal.dismiss('Cross click')" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div *ngIf="isLoadingtp" class="d-flex justify-content-center"><div class="spinner-border text-blue" role="status"><span class="sr-only">Loading...</span></div></div>
        <div class="container mb-4 mb-shadow" *ngIf="!isLoadingtp">
            <div class="row">
                <div class="w-100 boxboost px-3">
                    <div class="alert alert-danger m-2" role="alert" *ngIf="errorMessage_tp !== ''">
                        <i class="fa fa-exclamation-circle mr-1"></i>
                        {{errorMessage_tp}}
                    </div>
                    <div class="m-2">
                        <table class="table table-striped table-bordered table-hover table-md mt-3" id="PendingDetails">
                            <thead>
                                <tr class="text-center">
                                    <th style="width:40px;">#</th>
                                    <th scope="col">Code</th>
                                    <th scope="col" style="width:40%;">Description</th>
                                    <th scope="col">Fees</th>
                                    <th scope="col">Ins. Payment </th>
                                    <th scope="col">Patient Cost</th>
                                </tr>
                            </thead>
                            <tbody id="tbyPendingDetails">
                                <!-- ngRepeat: plan in TreatmentPlanDetails -->
                                <tr *ngFor="let plan of treatmentPlan; index as i;">
                                    <td style="width:40px;" class="ng-binding">{{i+1}}</td>
                                    <td scope="col" class="ng-binding">{{plan.procedure_code}}</td>
                                    <td scope="col" class="ng-binding">{{plan.description}}</td>
                                    <td scope="col" class="text-right ng-binding">{{plan.amount}}</td>
                                    <td scope="col" class="text-right ng-binding">{{plan.insurance_payment}}</td>
                                    <td scope="col" class="text-right ng-binding">{{plan.patientEst}}</td>
                                </tr><!-- end ngRepeat: plan in TreatmentPlanDetails -->
    
                                <tr class="text-right">
                                    <td colspan="3">Total</td>
                                    <td scope="col" class="text-right ng-binding">{{totalFees | currency }}</td>
                                    <td scope="col" class="text-right ng-binding">{{insurancePayment | currency }}</td>
                                    <td scope="col" class="text-right ng-binding">{{patientCost | currency }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="container mb-4 mb-shadow" id="patientFinanceOption" style="background-color:#fff;"
            *ngIf="!hasTreatmentPlanExist && !isLoadingtp && hasTreatmentPlanAvailable">
            <div class="row">
                <div class="mt-3 mb-5 text-center col-sm-12">
                    <h3>Treatment Plan and Payment Options</h3>
                </div>
                <input type="hidden" name="pName" id="pName" value="Mark Grant">
                <div class="col-7 ml-5" id="patient_details">
                    <table class="table table-bordered table-striped border-light mb-5 inline" style="border-color:#f5f5f5">
                        <tbody>
                            <tr>
                                <td style="width: 30%;">Patient Name</td>
                                <td class="ng-binding">{{name}}</td>
                            </tr>
                            <tr>
                                <td>Presented by</td>
                                <td>{{loggedUserName}}</td>
                            </tr>
                            <tr>
                                <td>Date</td>
                                <td class="ng-binding">{{currentDate | date:'MM/dd/yyyy'}}</td>
                            </tr>
                            <tr>
                                <td>Treatment plan #</td>
                                <td class="ng-binding">{{treatmentPlanNumber}}</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="font-weight-bold mt-4 mb-1">
                        <h4>Summary of Treatment Plan</h4>
                    </div>
                    <table class="table table-bordered table-hover table-md mt-3 mb-5">
                        <thead>
                            <tr>
                                <th style="width:50px">#</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- ngRepeat: plan in TreatmentPlanDetails -->
                            <tr *ngFor="let plan of treatmentPlan; index as i;">
                                <td class="ng-binding">{{i+1}}</td>
                                <td class="ng-binding">{{plan.description}}</td>
                            </tr><!-- end ngRepeat: plan in TreatmentPlanDetails -->
                            <tr>
                                <td colspan="2">
                                    <div class="row">
                                        <div class="col-sm-9 text-right">Total Treatment Plan Fee</div>
                                        <div class="col-sm-3 text-right ng-binding">{{totalFees | currency}}</div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-9 text-right">Primary Insurance</div>
                                        <div class="col-sm-3 text-right ng-binding">{{primaryInsurance | currency}}</div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-9 text-right">Insurance Discounts</div>
                                        <div class="col-sm-3 text-right ng-binding">{{insuranceDiscount | currency}}</div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-9 text-right">Possible Insurance Payments</div>
                                        <div class="col-sm-3 text-right ng-binding">{{insurancePayment | currency}}</div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-9 text-right">Your Total Amount Due</div>
                                        <div class="col-sm-3 text-right ng-binding">{{patientCost | currency}}</div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
    
                <div class="col-4 text-center">
                    <img src="./assets/assets/images/dental.png" width="65%" />
                </div>
            </div>
    
            <div class="row">
                <div class="mt-1 mb-1 ml-4 text-left col-sm-9">
                    <div class="form-row align-items-center">
                        <div class="col-auto my-1">
                            <label class="font-weight-bold" style="margin-top: 5px;">Payment Option</label>
                        </div>
                        <div class="col-auto ml-5 my-2">
                            <div class="custom-control custom-checkbox mr-sm-2">
                                <input type="checkbox" class="custom-control-input" id="chkMonthlyPay" onclick="monthlyPayment()">
                                <label class="custom-control-label" for="chkMonthlyPay">Monthly
                                    Payment</label>
                            </div>
                        </div>
                        <div class="col-auto my-1">
                        </div>
                    </div>
    
                </div>
            </div>
    
            <div class="row pt-2 pb-2 mx-4">
                <div class="table-responsive">
                    <table class="table table-bordered" id="tpo">
                        <tbody>
                            <tr class="row-bg" id="pay-full">
                                <td colspan="4">
                                    <label class="chkcontainer mr-5">
                                        <input type="radio" class="custom-radio" id="rdoPayfull" name="rdoPaymentMode"
                                            value="full" checked onclick="paymentMode()"/>
                                        <span class="checkmark"></span>
                                        Pay in full
                                    </label>
                                    <span class="float-right mr-5 pr-5">Total Due Today:
                                        {{patientCost | currency:'$'}}</span>
                                </td>
    
                            </tr>
                            <tr class='alt-row-bg' style="display: none;">
                                <td rowspan="3">
                                    <label class="chkcontainer">
                                        <input type="radio" class="custom-radio" id="rdoMonthly" name="rdoPaymentMode"
                                            value="month" onclick="paymentMode()"/>
                                        <span class="checkmark"></span>
                                        Monthly Payments - Denefits® Plan
                                    </label>
                                </td>
                                <td class="m-1">
                                    <label class="chkcontainer">
                                        <input type="radio" class="custom-radio" id="rdoMonthlyPay6" name="rdoPayType"
                                            value="6" onclick="paymentType()"/>
                                        <span class="checkmark"></span>
                                        6 Monthly Payments of
                                    </label>
                                </td>
                                <td>
                                    <span class="p-1"> {{patientCost/6 | currency:'$'}}</span>
                                </td>
                                <td rowspan="3">
                                    Down payment : $0.00
                                    <p class="mt-2 mb-2">Monthly payments include a 10% fee<br>(compounded
                                        interest)</p>
                                </td>
                            </tr>
                            <tr class="alt-row-bg" style="display: none;">
                                <td>
                                    <label class="chkcontainer">
                                        <input type="radio" class="custom-radio" id="rdoMonthlyPay12" name="rdoPayType"
                                            value="12" onclick="paymentType()"/>
                                        <span class="checkmark"></span>
                                        12 Monthly Payments of
                                    </label>
                                </td>
                                <td><span class="p-1"> {{patientCost/12 | currency:'$'}}</span></td>
                            </tr>
                            <tr class="alt-row-bg" style="display: none;">
                                <td>
                                    <label class="chkcontainer">
                                        <input type="radio" class="custom-radio" id="rdoMonthlyPay18" name="rdoPayType"
                                            value="18" onclick="paymentType()"/>
                                        <span class="checkmark"></span>
                                        18 Monthly Payments of
                                    </label>
                                </td>
                                <td><span class="p-1"> {{patientCost/18 | currency:'$'}}</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
    
            <div class="row pt-4 pb-2 mx-4 align-items-center h-100">
                <p class="terms">The Denefits Plan includes a management fee of 10%. I understand the
                    Denefits and More Mastercard terms
                    of service and fees. I understand that the amount due is my responsibility and that
                    insurance is billed
                    as a courtesy to assist me in paying my obligation. I understand that insurance figures
                    provided are
                    estimates only. I understand that this estimate is NOT a guarantee of payment by my
                    insurance. If the
                    insurance company pays more, I will receive a refund. If the insurance company pays
                    less, I will either
                    receive a bill for the difference, have my credit card on file charged for the amount
                    owed, or will have
                    my payment plan extended, whatever the dental practice deems best. I understand that if
                    my insurance
                    company fails to pay within 60 days of the claim being submitted, the full amount due is
                    my
                    responsibility and I will make payment in full. I understand that the above estimated
                    fees are based on
                    my treatment plan as listed above. The treatment plan may change, altering the total
                    cost of care. I
                    understand I will be charged a $40 cancellation fee if I cancel an appointment later
                    than 10am the
                    previous business day.</p>
            </div>
            <div class="row pt-1 pb-1 mx-2 align-items-center h-100 mt-3">
                <div class="col-sm-12">
                    <div class="mb-5">
                        <div class="custom-control custom-checkbox mr-sm-2">
                            <input type="checkbox" class="custom-control-input" id="chkAgreePayment"
                                ng-model="AgreePayment">
                            <label class="custom-control-label" for="chkAgreePayment">I Agree</label>
                        </div>
                    </div>
    
                </div>
                <div class="col-sm-3">
                    <div class="border-bottom">
                        Date: {{currentDate}}
                    </div>
    
                </div>
            </div>
            <!-- Signature box -->
            <!-- <div class="row pt-3 pb-5 mx-3 align-items-center h-100 mt-2">
                                    <div class="col-sm-12" style="border-bottom: 1px solid #222;">
                                        <div id="signature-pad" class="signature-pad">
                                            <div class="signature-pad--body">
                                                <canvas></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div> -->
    
            <div class="row pt-3 pb-5 mx-3 align-items-center h-100 mt-5">
                <div class="col-sm-12" style="border-bottom: 1px solid #222;">
                    <div class="wrapper mb-1">
                        <canvas id="signature-pad" class="signature-pad" width="1024" height="198" #canvasEl></canvas>
                    </div>
                    <div style="display: none;">
                        <button id="save-png">Save as PNG</button>
                        <button id="save-jpeg">Save as JPEG</button>
                        <button id="save-svg">Save as SVG</button>
                        <button id="draw">Draw</button>
                        <button id="erase">Erase</button>
                    </div>
                </div>
                <label for="exampleFormControlTextarea1">Patients (or Responsible Party) Signature</label>
            </div>
            <i appLoadScript [script]="'./assets/assets/custom/signature/signature_pad.umd.js'"></i>
            <!-- <i appLoadScript [script]="'./assets/assets/custom/signature/popcanvas.js'"></i> -->
            <i appLoadScript [script]="'./assets/assets/custom/signature/app.js'"></i>
        </div>

        <div class="container mb-5 boxboost" style="background-color:#fff; border:1px solid #d0d0d0;"
            id="patientFinanceOptionConfirmed" *ngIf="hasTreatmentPlanExist && hasTreatmentPlanAvailable">
            <div class="col-12 mt-3">
                <div class="alert alert-warning text-center" *ngIf="message !==''">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                    <i class="fa fa-exclamation-triangle"></i> <strong>{{messageStatus}}! </strong> {{message}} 
                </div>
            </div>
            <img [src]="treatmentPlanPaymentConsentImage" title="Payment Option" id="imgPaymentOption"
                style="width: 100%;" />
        </div>
    
        <div class="container mb-5 boxboost" style="background-color:#fff; border:1px solid #d0d0d0; display: none;"
            id="patientFinanceOptionStatic">
            <div class="mt-3 mb-5 text-center col-sm-12">
                <h3>Treatment Plan and Payment Options</h3>
            </div>
            <div class="my-5">
                <div class="row h-100 py-3 align-items-center justify-content-center" id='responseStatus'>
                    <div class="col-sm-6">
                        <div class="alert-box  mx-auto">
                            <div class="alert alert-secondary alert-bg">
                                <div class="alert-icon text-center">
                                    <i class="far fa-check-circle fa-3x" aria-hidden="true"></i>
                                </div>
                                <div class="alert-message text-center" id="responseMessage">
                                    <!--<strong>Success!</strong>-->Hi {{name}}, {{message}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <img src='' id='canvasimage' class="staticImage" />
            </div>
        </div>
    
        <div class="container mx-auto mb-2" id="alertWindow" style="display: none;">
            <div class="alert alert-danger" id="alertType">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <i class="fas fa-times-circle" style="font-size: 15px;"></i> <span id="errorMessage"></span><a href="#"
                    class="alert-link"></a> !!
            </div>
        </div>
    </div>
    <div class="modal-footer" *ngIf="!isLoadingtp">
        <input type="hidden" id="patientId" [ngModel]="patId" name="patientId"/>
        <input type="hidden" id="treatmentPlanId" [ngModel]="treatmentPlanNumber"  name="TreatmentPlanId"/>
        <input type="hidden" id="username" [ngModel]="patUserName" name="patUserName"/>
        <input type="hidden" id="loggedUserId" [ngModel]="loggedUserId" name="loggedUserId"/>

        <button type="button" class="btn btn-primary" id="btnDownload" onclick="saveAsImage()" *ngIf="!hasTreatmentPlanExist && hasTreatmentPlanAvailable">Submit</button>
        <button type="button" class="btn btn-danger" id="clear"  *ngIf="!hasTreatmentPlanExist && hasTreatmentPlanAvailable">Clear</button>
        <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')" aria-label="Close">Close</button>
    </div>    
</ng-template>


<i appLoadScript [script]="'./assets/assets/custom/common.js'"></i>
<i appLoadScript [script]="'./assets/assets/custom/payoption.js'"></i>
<i appLoadScript [script]="'./assets/assets/js/app.js'"></i>         
<i appLoadScript [script]="'./assets/plugins/sweet-alert2/sweetalert2.min.js'"></i>

<!-- https://codepen.io/rongxike/pen/MJMopq -->